import{_ as l,r as h,c as p,b as i,d as s,a as e,w as n,e as t,o as k}from"./app-kL6t4lX4.js";const r="/assets/1-Cj1hfSdC.png",d="/assets/2-BxWwjPZq.png",o={},c=t('<blockquote><p>前言：原生小程序与现在的单页面应用开发框架上有些许的不同，还有微信做的许多限制，导致在开发过程中会遇到很多大大小小的问题，特此记录。<code>学而时习之，不亦乐乎</code></p></blockquote><h2 id="在小程序中使用-npm-包" tabindex="-1"><a class="header-anchor" href="#在小程序中使用-npm-包"><span>在小程序中使用 npm 包</span></a></h2><p><a href="https://developers.weixin.qq.com/miniprogram/dev/devtools/npm.html" target="_blank" rel="noopener noreferrer">微信官方文档-npm 支持</a> 看过官方文档其实也并不是很清楚，文档有以下 tips：</p><blockquote><p>tips: miniprogramRoot 字段不存在时，miniprogramRoot 就是 project.config.js 所在的目录</p></blockquote><p>实际操作：和普通 npm 项目一样，在根目录下执行<code>npm init</code>生成了<code>package.json</code>,然后再装所需要的包，最后根据他第二步，一直往下执行。但在实际使用中，还是无法完全达到随心所欲的使用 npm 各种包，这一点要根据具体使用的什么包来对症下药，但使用中花费的力气有时还不如手写来的快了，这点是微信小程序比较坑的地方。</p><h2 id="小程序长按识别二维码" tabindex="-1"><a class="header-anchor" href="#小程序长按识别二维码"><span>小程序长按识别二维码</span></a></h2><p>小程序目前的版本（2021-06-05）只支持以下场景识别公众号（订阅号）二维码</p>',7),g=i("li",null,"小程序内长按识别结果：不可以",-1),m=i("li",null,"小程序内 webview(自定义 H5)：不可以",-1),y=t(`<p>所以要达到在小程序里长按图片识别公众号二维码的目的，实现方法只有使用<code>&lt;webview&gt;</code>内嵌公众号文章，在文章里放公众号的二维码。<a href="https://zhuanlan.zhihu.com/p/253214379" target="_blank" rel="noopener noreferrer">具体实现方法</a></p><h2 id="小程序选择图片转-base64" tabindex="-1"><a class="header-anchor" href="#小程序选择图片转-base64"><span>小程序选择图片转 base64</span></a></h2><p>这个在 web 编程中的方法可能多种多样，但是大部分都不适用于小程序，在尝试很多方法之后，发现小程序官方提供<a href="https://developers.weixin.qq.com/miniprogram/dev/api/file/wx.getFileSystemManager.html" target="_blank" rel="noopener noreferrer">wx.getFileSystemManager</a>方法。</p><div class="language-javascript line-numbers-mode" data-ext="javascript" data-title="javascript"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">wx</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">chooseImage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">({</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">  count</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  success</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">res</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =&gt;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    wx</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">getFileSystemManager</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">().</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">readFile</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">({</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">      filePath</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> res</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">tempFilePaths</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">],</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  // 选择图片返回的临时路径</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">      encoding</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">base64</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  // 编码格式</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      success</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">res1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =&gt;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        // 最终的base64</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">        let</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> base64</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> \`</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">data:image/png;bases64,</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">\${</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">res1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">data</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">}</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">\`</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">        console</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">base64</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">      }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    })</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">})</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><a href="https://developers.weixin.qq.com/miniprogram/dev/api/file/FileSystemManager.readFile.html" target="_blank" rel="noopener noreferrer">FileSystemManager.readFile</a> 读取本地文件内容</p></blockquote><p><img src="`+r+'" alt="参数"></p><p><img src="'+d+'" alt="encoding合法值"></p><p> </p>',8);function u(v,b){const a=h("font");return k(),p("div",null,[c,i("ul",null,[i("li",null,[s("公众号内长按识别结果："),e(a,{color:"#B22222"},{default:n(()=>[s("可以")]),_:1})]),g,i("li",null,[s("小程序内 webview(公众号文章)："),e(a,{color:"#B22222"},{default:n(()=>[s("可以")]),_:1})]),m,i("li",null,[s("小程序客服消息长按识别："),e(a,{color:"#B22222"},{default:n(()=>[s("可以")]),_:1})])]),y])}const D=l(o,[["render",u],["__file","index.html.vue"]]),B=JSON.parse(`{"path":"/article/vgbf00f0/","title":"微信小程序开发日记","lang":"zh-CN","frontmatter":{"title":"微信小程序开发日记","author":"杨少侠","createTime":"2021/06/05 13:56:53","permalink":"/article/vgbf00f0/","tags":["前端"],"head":[["script",{"id":"check-dark-mode"},";(function () {const um= localStorage.getItem('vuepress-theme-appearance') || 'auto';const sm = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;const isDark = um === 'dark' || (um !== 'light' && sm);document.documentElement.dataset.theme = isDark ? 'dark' : 'light';})();"],["script",{"id":"check-mac-os"},"document.documentElement.classList.toggle('mac', /Mac|iPhone|iPod|iPad/i.test(navigator.platform))"]]},"headers":[{"level":2,"title":"在小程序中使用 npm 包","slug":"在小程序中使用-npm-包","link":"#在小程序中使用-npm-包","children":[]},{"level":2,"title":"小程序长按识别二维码","slug":"小程序长按识别二维码","link":"#小程序长按识别二维码","children":[]},{"level":2,"title":"小程序选择图片转 base64","slug":"小程序选择图片转-base64","link":"#小程序选择图片转-base64","children":[]}],"readingTime":{"minutes":1.93,"words":580},"git":{"createdTime":1718438140000,"updatedTime":1718438140000,"contributors":[{"name":"jiangshiyang","email":"1589744751@qq.com","commits":1}]},"filePathRelative":"前端/微信小程序开发日记.md","categoryList":[{"id":"9abfe4","sort":10000,"name":"前端"}]}`);export{D as comp,B as data};
